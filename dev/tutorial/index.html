<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · MPSGE.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MPSGE.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Store-the-model-elements-ready-for-build-by-adding-them"><span>Store the model elements ready for build by adding them</span></a></li><li><a class="tocitem" href="#Check-the-benchmark-solution"><span>Check the benchmark solution</span></a></li><li><a class="tocitem" href="#See-the-underlying-model-equations"><span>See the underlying model equations</span></a></li><li><a class="tocitem" href="#Run-Counterfactuals"><span>Run Counterfactuals</span></a></li></ul></li><li><a class="tocitem" href="../userguide/">User Guide</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/anthofflab/MPSGE.jl/blob/main/docs/src/tutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Add the MPSGE package</p><h5 id="Activate-the-package-with"><a class="docs-heading-anchor" href="#Activate-the-package-with">Activate the package with</a><a id="Activate-the-package-with-1"></a><a class="docs-heading-anchor-permalink" href="#Activate-the-package-with" title="Permalink"></a></h5><pre><code class="nohighlight hljs">using MPSGE</code></pre><p>Start by naming the model using any Julia-legal variable name, without spaces etc. The Julia style guide suggests lower case for variable names.</p><pre><code class="nohighlight hljs">m = Model()</code></pre><h2 id="Store-the-model-elements-ready-for-build-by-adding-them"><a class="docs-heading-anchor" href="#Store-the-model-elements-ready-for-build-by-adding-them">Store the model elements ready for build by adding them</a><a id="Store-the-model-elements-ready-for-build-by-adding-them-1"></a><a class="docs-heading-anchor-permalink" href="#Store-the-model-elements-ready-for-build-by-adding-them" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Scalars and arrays can be used to provide values, inlcuding for model parameters like elasticities, but can not be changed within the model in counterfactuals, so any value that needs to be updated should be added as a model Parameter.   To access model Parameters in model functions, at this point they must be part of expressions, so for referencing the value of <code>elast</code>, it must be within an evaluated expression :(1 * elast). The model can be built in any order, so long as all elements referred to have been previously defined. For that reason a standard structure is: load the data, scalars, indexes; add model parameters, sectors, commodities, auxiliary variables, and consumers; add production and demand functions.</p></div></div><h4 id="Add-data"><a class="docs-heading-anchor" href="#Add-data">Add data</a><a id="Add-data-1"></a><a class="docs-heading-anchor-permalink" href="#Add-data" title="Permalink"></a></h4><p>Use DenseAxisArrays for any data that&#39;s indexed, including a table. Use &#39;missing&#39; to hold any spaces (see <a href="https://github.com/anthofflab/MPSGE.jl/blob/main/examples/example5.jl">example 5</a>). For a simple scalar model, it&#39;s straightforward just to use the values when defining the elements, but we&#39;ll include a DenseAxisArray for illustration.</p><pre><code class="nohighlight hljs">MPSGE.JuMP.Containers
sampleindex = [:x]
data = DenseAxisArray(Float64[100], sampleindex)</code></pre><h4 id="Add-Parameters"><a class="docs-heading-anchor" href="#Add-Parameters">Add Parameters</a><a id="Add-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Parameters" title="Permalink"></a></h4><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There is a &#39;functional&#39; and macro version for all model definition elements. The macro versions <em>may</em> lag while the package is still in development. We&#39;ll show both here - they are equivalent.</p></div></div><pre><code class="nohighlight hljs">sub_elas_x = add!(m, Parameter(:sub_elas_x, value=1.5, description=&quot;Substitution elasticity between labor and kapital in sector X&quot;))

# Without the optional description
sub_elas_y = add!(m, Parameter(:sub_elas_y, value=2.))

# The macro version
@parameter(m, sub_elas_u, 0.5)
@parameter(m, transf_elas_y, 0., description=&quot;Transformation Elasticity for sector Y, irrelevant because there&#39;s only 1 output&quot;)</code></pre><h4 id="Add-Commodities,-default-benchmark-price1"><a class="docs-heading-anchor" href="#Add-Commodities,-default-benchmark-price1">Add Commodities, default benchmark price=1</a><a id="Add-Commodities,-default-benchmark-price1-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Commodities,-default-benchmark-price1" title="Permalink"></a></h4><pre><code class="nohighlight hljs">PX = add!(m, Commodity(:PX))
PY = add!(m, Commodity(:PY), benchmark=1.)
PU = add!(m, Commodity(:PU, description=&quot;The Utility Commodity&quot;))
@commodity(m, PU)
@commodity(m, PL)
@commodity(m, PK)</code></pre><h4 id="Add-Sectors"><a class="docs-heading-anchor" href="#Add-Sectors">Add Sectors</a><a id="Add-Sectors-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Sectors" title="Permalink"></a></h4><pre><code class="nohighlight hljs">@sector(m, X)
Y = add!(m, Sector(:Y))
@sector(m, U, description=&quot;Sector U&quot;)</code></pre><h4 id="Add-Consumer(s)"><a class="docs-heading-anchor" href="#Add-Consumer(s)">Add Consumer(s)</a><a id="Add-Consumer(s)-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Consumer(s)" title="Permalink"></a></h4><p>Here the benchmark value is important. This value will be the sum of endowments any taxes transferred to the consumer in the benchmark callibration of the model.</p><pre><code class="nohighlight hljs">@consumer(m, RA, benchmark = 150., description=&quot;Representative Agent&quot;)</code></pre><h4 id="Add-Production-Functions"><a class="docs-heading-anchor" href="#Add-Production-Functions">Add Production Functions</a><a id="Add-Production-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Production-Functions" title="Permalink"></a></h4><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Outputs and Inputs are within <code>[]</code> Arrays, even if single.  Outputs must always be first.</p></div></div><pre><code class="nohighlight hljs">add!(m, Production(X,:($transf_elas_x*1.), :($sub_elas_x*1.), [Output(PX, data[:x])], [Input(PL, 50), Input(PK, 50)]))
@production(m, Y, :($transf_elas_y*1.), :($sub_elas_y*1.), [Output(PY, 50)], [Input(PL, 20), Input(PK, 30)])
@production(m, U, 0, :($sub_elas_u*1.), [Output(PU, 150)], [Input(PX, 100), Input(PY, 50)])</code></pre><h4 id="Add-Demand-Functions"><a class="docs-heading-anchor" href="#Add-Demand-Functions">Add Demand Functions</a><a id="Add-Demand-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Demand-Functions" title="Permalink"></a></h4><pre><code class="nohighlight hljs">@demand(m, RA, 1., [Demand(PU, 150)], [Endowment(PL, :(70 * $endow)), Endowment(PK, 80.)])</code></pre><h2 id="Check-the-benchmark-solution"><a class="docs-heading-anchor" href="#Check-the-benchmark-solution">Check the benchmark solution</a><a id="Check-the-benchmark-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-benchmark-solution" title="Permalink"></a></h2><p>After the model is established and saved under the model name, it is standard to check that the model is mathematically balanced in the benchmark by solving with 0 iterations.</p><pre><code class="nohighlight hljs">solve!(m, cumulative_iteration_limit=0)</code></pre><p>If the model solves with zero iterations, we know that the model and data are balanced and callibrated in the benchmark.      If not, you will get an error  <code>Did not solve with error: CumulativeMinorIterationLimit.</code>       The <code>Major Iteration Log</code> from PATH will display the variable(s), preceded by &quot;F_&quot; <code>(label)</code> with the largest marginal value, that is the variables that have the <code>residual</code>/solved value or <code>inorm</code>that is larger than the tolerance set, which can be useful for troubleshooting.       You can also run <code>solve!(m)</code> without the iteration limit and examine the values for all variables for more clues as to where the benchmark may be unbalanced.</p><h2 id="See-the-underlying-model-equations"><a class="docs-heading-anchor" href="#See-the-underlying-model-equations">See the underlying model equations</a><a id="See-the-underlying-model-equations-1"></a><a class="docs-heading-anchor-permalink" href="#See-the-underlying-model-equations" title="Permalink"></a></h2><p>You can print the equations and their associated variables.</p><pre><code class="nohighlight hljs">algebraic_version(m)</code></pre><h2 id="Run-Counterfactuals"><a class="docs-heading-anchor" href="#Run-Counterfactuals">Run Counterfactuals</a><a id="Run-Counterfactuals-1"></a><a class="docs-heading-anchor-permalink" href="#Run-Counterfactuals" title="Permalink"></a></h2><p>Once the benchmark is established, update variable values and/or parameters, fix or unfix variables etc. and see the solution as in the simulated counterfactual scenario.</p><pre><code class="nohighlight hljs"># increase labor endowment by 10%
set_value(endow, 1.1)
# Set the consumer RA as the numeraire
set_fixed!(RA, true)
solve!(m)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../userguide/">User Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 13 July 2023 21:22">Thursday 13 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
